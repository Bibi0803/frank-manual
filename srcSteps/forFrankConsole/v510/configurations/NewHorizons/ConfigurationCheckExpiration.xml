<Module
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="../../../ibisdoc.xsd">
  <Adapter name="adapterCheckExpiration">
      <Receiver name="receiverCheckExpiration">
          <JavaListener name="listenerCheckExpiration" serviceName="listenerCheckExpiration"/>
      </Receiver>
      <Pipeline firstPipe="pipeQueryHowManyExpired">
          <SenderPipe name="pipeQueryHowManyExpired">
              <FixedQuerySender
                  name="senderQueryHowManyExpired"
                  datasourceName="jdbc/${instance.name.lc}"
                  queryType="select"
                  query="SELECT COUNT(*) AS cnt FROM product WHERE DATEDIFF(SECOND, modificationDate, NOW()) >= 120"/>
                  <Forward name="success" path="EXIT"/>
          </SenderPipe>
          <Exit state="success" path="EXIT" code="200"/>
      </Pipeline>
  </Adapter>
</Module>