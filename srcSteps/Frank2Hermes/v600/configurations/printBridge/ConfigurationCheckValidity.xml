<Module
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="./ibisdoc.xsd">
  <Adapter name="checkPrintRequestValidity">
    <Receiver name="receiverCheckPrintRequestValidity">
      <JavaListener name="listenerCheckPrintRequestValidity" serviceName="listenerCheckPrintRequestValidity"/>
    </Receiver>
    <Pipeline firstPipe="checkNumAddressLines">
      <XmlIfPipe name="checkNumAddressLines"
          xpathExpression="/report/numRight/text()"
          expressionValue="4"
          xsltVersion="2">
        <Forward name="then" path="reportValid"/>
        <Forward name="else" path="reportWrongNumAddressLines"/>
      </XmlIfPipe>
      <FixedResultPipe
          name="reportWrongNumAddressLines"
          fileName="validityInvalidAddressLineCount.xml">
        <Forward name="success" path="EXIT"/>
      </FixedResultPipe>
      <FixedResultPipe 
          name="reportValid"
          fileName="validityOk.xml">
        <Forward name="success" path="EXIT"/>
      </FixedResultPipe>
      <Exit state="success" path="EXIT" code="200"/>
    </Pipeline>
  </Adapter>
</Module>